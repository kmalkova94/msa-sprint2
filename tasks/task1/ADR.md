### <a name="_b7urdng99y53"></a>**Название задачи: Модернизация архитектуры сервиса Hotelio** 
### <a name="_hjk0fkfyohdk"></a>**Автор: Малкова Ксения**
### <a name="_uanumrh8zrui"></a>**Дата: 24.11.2025**
### <a name="_3bfxc9a45514"></a>**Функциональные требования**

|**№**|**Действующие лица или системы**|**Use Case**|**Описание**|
| :-: | :- | :- | :- |
| 1 | Пользователь | Создание и просмотр бронирований | Пользователь может совершать бронирование и просматривать существующие бронирования |
| 2 | Администратор | Просмотр информации о пользователе | Адмнистратор может получить информацию о пользователе, или получить отдельные сведения по конкретному пользователю |
| 3 | Пользователь | Просмотр информации об отеле | Пользователи могут получать информацию о конкретном отеле, отдельные характеристики отеля, а также получать списки отелей, отфильтрованные по отдельным параметрам |
| 4 | Пользователь | Работа с промокодами | Пользователи могут получить информацию о промокоде по коду, а также проверять промокод для конкретного пользователя |
| 5 | Пользователь | Просмотр отзывов | Пользователи могут просматривать отзывы об отеле и получать итоговую характеристику отеля |
|||||
### <a name="_u8xz25hbrgql"></a>**Нефункциональные требования**

|**№**|**Требование**|
| :-: | :- |
| 1 | Масштабируемость отдельных компонент |
| 2 | Отказоустойчивость |
| 3 | Доступность сервисов: API Gateway - 99,99%; Booking, Hotel, User services - 99,95%; Promo, Review services - 99,9% |
| 4 | Производительность: время отклика: API Gateway - < 50 мс, GET - < 100мс, POST/PUT - < 200 мс, сложные операции - < 500 мс, нагрузка всей системы - 10000 RPS |
| 5 | Безопасность: JWT - токены (expiration 15 min) |
|||

### <a name="_qmphm5d6rvi3"></a>**Проблемы**
Проблемы: 
    • Сложность сопровождения
    • Низкая масштабируемость
    • Невозможность гибкой разработки
    • Ограничения на фронтенде
    • Сложности с запуском новых фичей
    • Отсутствие изоляции данных - все сервисы работают с единой БД
    • Нельзя масштабировать только критичные компоненты
    • Нет разделения на роли с ограничением доступности определенных эндпоинтов
    • Нет эндпоинтов для публикации отзывов
    

### <a name="_qmphm5d6rvi3"></a>**Решение**
Переход на микросервисную архитектуру с помощью паттерна Strangler Fig, который:
        ○ дает возможность проработки ошибок на каждом этапе миграции,
        ○ требует меньшее количество ресурсов,
        ○ дает возможность работать с современными технологиями и улучшить качество сервиса;

Предполагается разделение монолитного приложения на следующие сервисы:
    • User service;
    • Hotel service;
    • Booking service;
    • Promo service;
    • Review service;
    • API Gateway.

Выбор наиболее критичных сервисов, с которых необходимо начать миграцию.
Booking service, Hotel service - критически важные сервисы. При недоступности бронирования и возможности искать, просматривать отели возникает риск потерять пользователей.
User service - можно просматривать информацию об отелях без авторизации, но нельзя зайти в личный кабинет проверить бронирование - негативный пользовательский опыт.
Promo service, Review service - важно, но не срочно.

Было принято решение начать миграцию на микросервисную версию продукта с сервисов Hotel service и Booking service как самых критичных.

Схема выделения Booking service из монолита описана в диаграмме hotelio_diagram.puml.

### <a name="_bjrr7veeh80c"></a>**Альтернативы**
Миграция на микросервисную версию сразу всего продукта.
Минусы подхода:
        ○ длительный период недоступности сервиса,
        ○ высокий риск ошибок в работе сервисов,
        ○ риск потери данных при миграции на изолированные БД,
        ○ необходимость большого количество ресурсов при поддержке монолита и одновременной разработке микросервисной версии,
        ○ Необходимость разработки микросервисной версии в короткий срок.

**Недостатки, ограничения, риски**

1. Необходимость обучения команды.
2. Усложнение инфраструктуры.

